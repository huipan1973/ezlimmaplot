<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jonathan Dreyfuss" />

<meta name="date" content="2018-08-15" />

<title>ezlimmaplot vignette</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">ezlimmaplot vignette</h1>
<h4 class="author"><em>Jonathan Dreyfuss</em></h4>
<h4 class="date"><em>2018-08-15</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Welcome to <strong>ezlimmaplot</strong>. This package is for plotting bioinformatics results, especially those from the <strong>ezlimma</strong> package. Here, I’ll load both packages, create some output with <strong>ezlimma</strong>, and then plot it with <strong>ezlimmaplot</strong>.</p>
</div>
<div id="install-package" class="section level2">
<h2>Install package</h2>
<p>See README.md.</p>
</div>
<div id="load-package" class="section level2">
<h2>Load package</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ezlimma)</code></pre></div>
<pre><code>## Loading required package: limma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ezlimmaplot)</code></pre></div>
</div>
<div id="simulate-data" class="section level2">
<h2>Simulate data</h2>
<p>To demonstrate the package on a dataset, I’ll simulate log2 expression data with 100 genes and 6 samples in two groups, with the first gene up-regulated in the first group. This is the example data from <strong>limma</strong> <code>contrasts.fit</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span><span class="op">*</span><span class="dv">6</span>, <span class="dt">sd=</span><span class="fl">0.3</span>), <span class="dt">nrow=</span><span class="dv">100</span>, <span class="dt">ncol=</span><span class="dv">6</span>)
<span class="kw">dimnames</span>(M) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">paste0</span>(<span class="st">&quot;gene&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(M)), <span class="kw">paste0</span>(<span class="st">&quot;sample&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(M)))
grp &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;First3&quot;</span>, <span class="st">&quot;Last3&quot;</span>), <span class="dt">each=</span><span class="dv">3</span>)
tissue &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;muscle&quot;</span>, <span class="st">&quot;liver&quot;</span>), <span class="dt">times=</span><span class="dv">3</span>)
covar_num &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">ncol</span>(M))
pheno &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">row.names =</span> <span class="kw">colnames</span>(M), <span class="dt">sample=</span><span class="kw">colnames</span>(M), grp, tissue, covar_num, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
M[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span>M[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">+</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
</div>
<div id="principal-component-analysis-pca" class="section level2">
<h2>Principal component analysis (PCA)</h2>
<p>We can plot the samples by their first two principal components using the <strong>ggplot2</strong> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ezpca</span>(M, pheno, <span class="dt">color=</span><span class="st">&quot;grp&quot;</span>, <span class="dt">name=</span><span class="ot">NA</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We set <code>name=NA</code> to suppress plotting to a PNG file. We pass <code>color=&quot;grp&quot;</code> via … to <strong>ggplot2</strong> <code>aes_string</code>, where <code>&quot;grp&quot;</code> can be any of <code>colnames(pheno)}</code>. We could similarly have used <code>color=&quot;tissue&quot;</code>. We can also facet by a phenotype column using the <code>facet</code> argument, which takes a formula.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ezpca</span>(M, pheno, <span class="dt">color=</span><span class="st">&quot;grp&quot;</span>, <span class="dt">facet =</span> <span class="st">&quot;. ~ tissue&quot;</span>, <span class="dt">name=</span><span class="ot">NA</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can also plot each covariate with <code>shape=&quot;grp&quot;</code> to PDF. The PDF is named “covar_pca.pdf” by default.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multi_covar_pca</span>(M, pheno, <span class="dt">grp.var=</span><span class="st">&quot;grp&quot;</span>, <span class="dt">covars=</span><span class="kw">c</span>(<span class="st">&quot;tissue&quot;</span>, <span class="st">&quot;covar_num&quot;</span>))</code></pre></div>
</div>
<div id="gene-level-differential-analysis" class="section level2">
<h2>Gene level differential analysis</h2>
<p>Assume we want to test if genes are changed in First3, in Last3, or in Last3 - First3. We can do this in two lines of code,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">contr.v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">First3=</span><span class="st">&quot;First3&quot;</span>, <span class="dt">Last3=</span><span class="st">&quot;Last3&quot;</span>, <span class="dt">Last3vsFirst3=</span><span class="st">&quot;Last3-First3&quot;</span>)
res &lt;-<span class="st"> </span><span class="kw">limma_contrasts</span>(M, <span class="dt">grp=</span>grp, <span class="dt">contrast.v =</span> contr.v)</code></pre></div>
<p>We add a column of gene symbols to the top genes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">signif</span>(res, <span class="dv">3</span>), <span class="dt">Gene.Symbol=</span><span class="ot">NA</span>)
res.df<span class="op">$</span>Gene.Symbol[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<p>This returns a data frame that looks like:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">First3.avg</th>
<th align="right">Last3.avg</th>
<th align="right">First3.p</th>
<th align="right">First3.FDR</th>
<th align="right">First3.logFC</th>
<th align="right">First3.FC</th>
<th align="right">Last3.p</th>
<th align="right">Last3.FDR</th>
<th align="right">Last3.logFC</th>
<th align="right">Last3.FC</th>
<th align="right">Last3vsFirst3.p</th>
<th align="right">Last3vsFirst3.FDR</th>
<th align="right">Last3vsFirst3.logFC</th>
<th align="right">Last3vsFirst3.FC</th>
<th align="left">Gene.Symbol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>gene1</td>
<td align="right">2.0600</td>
<td align="right">0.236</td>
<td align="right">0.00000</td>
<td align="right">0.000</td>
<td align="right">2.0600</td>
<td align="right">4.16</td>
<td align="right">0.156000</td>
<td align="right">0.741</td>
<td align="right">0.236</td>
<td align="right">1.18</td>
<td align="right">0.000000</td>
<td align="right">0.0000</td>
<td align="right">-1.820</td>
<td align="right">-3.53</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td>gene25</td>
<td align="right">0.2320</td>
<td align="right">0.593</td>
<td align="right">0.16300</td>
<td align="right">0.987</td>
<td align="right">0.2320</td>
<td align="right">1.17</td>
<td align="right">0.000401</td>
<td align="right">0.020</td>
<td align="right">0.593</td>
<td align="right">1.51</td>
<td align="right">0.125000</td>
<td align="right">0.7080</td>
<td align="right">0.360</td>
<td align="right">1.28</td>
<td align="left">B</td>
</tr>
<tr class="odd">
<td>gene74</td>
<td align="right">0.1170</td>
<td align="right">-0.609</td>
<td align="right">0.48200</td>
<td align="right">0.987</td>
<td align="right">0.1170</td>
<td align="right">1.08</td>
<td align="right">0.000278</td>
<td align="right">0.020</td>
<td align="right">-0.609</td>
<td align="right">-1.53</td>
<td align="right">0.002140</td>
<td align="right">0.0713</td>
<td align="right">-0.726</td>
<td align="right">-1.65</td>
<td align="left">C</td>
</tr>
<tr class="even">
<td>gene59</td>
<td align="right">-0.4540</td>
<td align="right">0.359</td>
<td align="right">0.00648</td>
<td align="right">0.198</td>
<td align="right">-0.4540</td>
<td align="right">-1.37</td>
<td align="right">0.031400</td>
<td align="right">0.431</td>
<td align="right">0.359</td>
<td align="right">1.28</td>
<td align="right">0.000593</td>
<td align="right">0.0297</td>
<td align="right">0.813</td>
<td align="right">1.76</td>
<td align="left">D</td>
</tr>
<tr class="odd">
<td>gene17</td>
<td align="right">-0.0929</td>
<td align="right">-0.469</td>
<td align="right">0.57600</td>
<td align="right">0.987</td>
<td align="right">-0.0929</td>
<td align="right">-1.07</td>
<td align="right">0.004930</td>
<td align="right">0.164</td>
<td align="right">-0.469</td>
<td align="right">-1.38</td>
<td align="right">0.110000</td>
<td align="right">0.7080</td>
<td align="right">-0.376</td>
<td align="right">-1.30</td>
<td align="left">E</td>
</tr>
<tr class="even">
<td>gene12</td>
<td align="right">0.4430</td>
<td align="right">-0.148</td>
<td align="right">0.00791</td>
<td align="right">0.198</td>
<td align="right">0.4430</td>
<td align="right">1.36</td>
<td align="right">0.372000</td>
<td align="right">0.917</td>
<td align="right">-0.148</td>
<td align="right">-1.11</td>
<td align="right">0.012200</td>
<td align="right">0.2430</td>
<td align="right">-0.591</td>
<td align="right">-1.51</td>
<td align="left">F</td>
</tr>
<tr class="odd">
<td>gene4</td>
<td align="right">0.4540</td>
<td align="right">0.092</td>
<td align="right">0.00651</td>
<td align="right">0.198</td>
<td align="right">0.4540</td>
<td align="right">1.37</td>
<td align="right">0.580000</td>
<td align="right">0.917</td>
<td align="right">0.092</td>
<td align="right">1.07</td>
<td align="right">0.124000</td>
<td align="right">0.7080</td>
<td align="right">-0.362</td>
<td align="right">-1.29</td>
<td align="left">G</td>
</tr>
<tr class="even">
<td>gene66</td>
<td align="right">0.3800</td>
<td align="right">-0.229</td>
<td align="right">0.02260</td>
<td align="right">0.323</td>
<td align="right">0.3800</td>
<td align="right">1.30</td>
<td align="right">0.169000</td>
<td align="right">0.741</td>
<td align="right">-0.229</td>
<td align="right">-1.17</td>
<td align="right">0.009890</td>
<td align="right">0.2430</td>
<td align="right">-0.609</td>
<td align="right">-1.52</td>
<td align="left">H</td>
</tr>
<tr class="odd">
<td>gene13</td>
<td align="right">-0.1770</td>
<td align="right">-0.383</td>
<td align="right">0.28800</td>
<td align="right">0.987</td>
<td align="right">-0.1770</td>
<td align="right">-1.13</td>
<td align="right">0.021700</td>
<td align="right">0.412</td>
<td align="right">-0.383</td>
<td align="right">-1.30</td>
<td align="right">0.381000</td>
<td align="right">0.8940</td>
<td align="right">-0.206</td>
<td align="right">-1.15</td>
<td align="left">I</td>
</tr>
<tr class="even">
<td>gene60</td>
<td align="right">0.1190</td>
<td align="right">-0.395</td>
<td align="right">0.47400</td>
<td align="right">0.987</td>
<td align="right">0.1190</td>
<td align="right">1.09</td>
<td align="right">0.017800</td>
<td align="right">0.412</td>
<td align="right">-0.395</td>
<td align="right">-1.32</td>
<td align="right">0.029200</td>
<td align="right">0.4170</td>
<td align="right">-0.514</td>
<td align="right">-1.43</td>
<td align="left">J</td>
</tr>
</tbody>
</table>
</div>
<div id="significance-histogram" class="section level2">
<h2>Significance histogram</h2>
<p>We can plot a histogram of the p-values and FDRs for all comparisons with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">signif_hist</span>(res, <span class="dt">name=</span><span class="ot">NA</span>) <span class="co">#not run</span></code></pre></div>
<p><code>signif_hist</code> plots four histograms per page, and this line will plot two histograms per comparison x 3 comparisons = 6 histograms. Thus, this takes more than one page, so it is not shown here.</p>
</div>
<div id="venn-diagram" class="section level2">
<h2>Venn diagram</h2>
<p>We may want to see which genes are up or down in each comparison, and how the significant genes (say p-value &lt; 0.05) behave in different comparisons using a Venn diagram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ezvenn</span>(<span class="dt">tab=</span>res, <span class="dt">p.cutoff =</span> <span class="fl">0.05</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="dotplot-and-boxplot" class="section level2">
<h2>Dotplot and boxplot</h2>
<p>We can plot the top gene by group in a dotplot or boxplot using <strong>ggplot2</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_by_grp</span>(M[<span class="dv">1</span>,], pheno<span class="op">$</span>grp, <span class="dt">name=</span><span class="ot">NA</span>, <span class="dt">type=</span><span class="st">&quot;dot&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_by_grp</span>(M[<span class="dv">1</span>,], pheno<span class="op">$</span>grp, <span class="dt">name=</span><span class="ot">NA</span>, <span class="dt">type=</span><span class="st">&quot;box&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can plot multiple genes, such as the first 5 genes where each gene will be on its own page in a PDF, by passing <code>object=M[1:5,]</code>.</p>
</div>
<div id="heatmap" class="section level2">
<h2>Heatmap</h2>
<p>We plot a heatmap of the expression of the first five genes across all samples using the <strong>pheatmap</strong> package. We assume their gene symbols are “A”, “B”, “C”, “D”, “E”. <code>ezheat</code> requires a data frame, so we make a phenotype data frame with only one column for the group, and with <code>rownames(pheno)==colnames(M)</code>, which <strong>pheatmap</strong> checks for.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)
pheno.df &lt;-<span class="st"> </span>pheno[,<span class="st">&quot;grp&quot;</span>,drop=F]
topgenes &lt;-<span class="st"> </span><span class="kw">rownames</span>(res.df)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="kw">ezheat</span>(M[topgenes,], <span class="dt">labrows =</span> res.df[topgenes, <span class="st">&quot;Gene.Symbol&quot;</span>], <span class="dt">pheno.df=</span>pheno.df, <span class="dt">name=</span><span class="ot">NA</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We see a color bar for the phenotype groups and the strongest change in metabolite “A”.</p>
</div>
<div id="volcano-plots" class="section level2">
<h2>Volcano plots</h2>
<p>We can create volcano plots, which have logFC on the x-axis and log(p-value) on the y-axis, for a comparison using <strong>ggplot2</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ezvolcano</span>(<span class="dt">tab=</span>res.df, <span class="dt">comparison =</span> <span class="st">&quot;First3&quot;</span>, <span class="dt">name=</span><span class="ot">NA</span>, <span class="dt">lab.col=</span><span class="st">&quot;Gene.Symbol&quot;</span>, <span class="dt">ntop.sig =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can automatically create a PDF with volcano plots for all comparisons with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multi_volcano</span>(<span class="dt">tab=</span>res.df, <span class="dt">lab.col=</span><span class="st">&quot;Gene.Symbol&quot;</span>, <span class="dt">ntop.sig =</span> <span class="dv">1</span>)</code></pre></div>
</div>
<div id="system-info" class="section level2">
<h2>System info</h2>
<p>Here is the information on the system on which this document was compiled:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.5.0 (2018-04-23)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 7 x64 (build 7601) Service Pack 1
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ezlimmaplot_0.0.0.9000 ezlimma_0.1.6          limma_3.36.1          
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.17       knitr_1.20         magrittr_1.5      
##  [4] munsell_0.4.3      colorspace_1.3-2   rlang_0.2.1       
##  [7] highr_0.6          stringr_1.3.1      plyr_1.8.4        
## [10] tools_3.5.0        grid_3.5.0         gtable_0.2.0      
## [13] htmltools_0.3.6    yaml_2.1.19        lazyeval_0.2.1    
## [16] rprojroot_1.3-2    digest_0.6.15      tibble_1.4.2      
## [19] RColorBrewer_1.1-2 reshape2_1.4.3     ggplot2_3.0.0     
## [22] evaluate_0.10.1    rmarkdown_1.9      labeling_0.3      
## [25] pheatmap_1.0.10    stringi_1.1.7      pillar_1.2.3      
## [28] compiler_3.5.0     scales_0.5.0       backports_1.1.2</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
